{-|
Module      : HexPalette
Description : hex palette example
Copyright   : Just Nothing
Stability   : in progress
-}
module HexPalette(mainPallete) where
import Data.Char
-- | главная палитра, передаваемая как основная
mainPallete :: [(Float,Float,Float)]
mainPallete = exportPallete `seq` exportPallete -- stdGrad 128
-- | палитра на экспорт, ленивая заготовка
exportPallete :: [(Float,Float,Float)]
exportPallete = zipTo3 list
-- | сворачивание списка в кортежи по три компоненты
zipTo3 :: [Float] -> [(Float,Float,Float)]
zipTo3 (x:y:z:lst) = (x,y,z) : (zipTo3 lst)
zipTo3 _ = []
-- | конвертация в Float и нормировка списка вида "hh"
list :: [Float]
list = map ((/255) . fromIntegral . convert) (parser sourcePallete)
-- | конвертация списка из шестнадцатиричного байта в Int
convert :: [Char] -> Int
convert (x:y:[]) = (digitToInt x)*16 + (digitToInt y)
convert _ = error "Convert"
-- | парсер строки hex кода на подстроки по два символа (один байт)
parser :: String -> [String]
parser (x:y:xs) = [x,y] : (parser xs)
parser _ = []
-- | огромная палитра в hex коде
sourcePallete :: String
sourcePallete = "A42D349C27319D222A9B1B269A1524980A2198082098061F98061E99071E97091FA00D1DB6141BBB151BC1171BCD1B1BDA1D1AE42019EF2418F32718F62B18F93117F93217F93318FA361AFB361CFC371EFC3A21F74625F54A26F44F28F3592CF2612FF26A33F37138F3783DF57D42F88641F78E42F69A41F5A745F3B248F3BB4CF3C24FF4C457F5C357F7C358F9C15AF9C058FBC45AFAC75CFACB61FAD166FAD56DFAD573FAD378F7CD7DF6C47FF7BE7DF7B679F7B076F7AB74F7A673F8A06FFA996AFA9064F9855EF97856F96A4CF95B43F94D3BF73F35F73130F6272BF21F27EC1925E81422E61020E50B1DE6081CE6081BE8081BE90719EA0818E80919E60B1AE50F1CE4131CE5181DE7211FEB2D22EF3925F54629F9532DFB6132FC6F3AFC7A40FC8145FC8648FC894AF9894CF3874DE8834EDE804ED9814ED8854FD88A53D99058DA9259DE9259E28F57E18A54DC8151D8774CD77045D76B42D96F44E1834AEB904DF69D51F8A353FBA956FAA855F9A755F29A4EF0944DEF8F4CEF8A4BEF854AEF8047F07C45F17B44F27A44F27340F0703FEE6E3EEE6B3EEF693FEF673FEF663FF45F3DF85C3CFC593BFC593CFC5A3EFA5B3EF85D3FEB603DDE5E3CC6583AB95138AD4B37A24336973C359538369435377C2B3176252E71202B7019256F13206F0F1D6F0C1B7306178003179305179C0A19A60F1BB2181EBE2221C42823CB2E26E34830EC5434F56039F76B3EFA7643FA7C45FB8347FB904EFC9F55FCBD65FCC96DFDD676FDDA79FDDF7DFDE684FDEA87FDED88FDEB85FDE982FAE57CF8E176F4DF73F0DD70EED46CEECB68EEB862EFB460F0B05EF0AD5DF1AB5CF6AC5AF0B059EEB25CEDB360EDB565EDB668EEB76CEFBC74F2BF7DFAC488FCCE91FCE4A2FCECA7FCF5ADFCF7AEFCF9AFFDFAB0FDF9AEFDF5A7FDF1A3FDEDA0FCEB9EFCEA9DFCE497FCDC90FDD289FDC581FDAB6DFDA467FD9D62FE8D59FD8053FE754DFD6A48FE5542FD4E3EFD473BFD4439FD4138FE3D36FE3935FE3834FE3833FC3833FC3832FC3832FB3833F63933EB3834DF3836C73637BB3436AF3236A92F35"
-- | стандартная палитра оттенков красный-синий,
-- с фиксированной яркостью, но переменной с длиной по параметру
stdGrad :: Int -> [(Float,Float,Float)]
stdGrad len = [(lr+(cfi lt),st,lb-(cfi lt)) | lt <- [1,2..len]]
  where
    st = 128/255
    lr = 0.0
    lb = 1.0
    lc = 1/(fromIntegral len)
    cfi = (lc *) . fromIntegral